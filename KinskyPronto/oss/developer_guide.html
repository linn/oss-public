<html>
<head>
<title>
Kinsky Pronto Developer
</title>
<style type="text/css">
<!--
body {

  font-family: "Helvetica, Tahoma";	
	
    overflow-x: hidden;
    -webkit-user-select: none;
    -webkit-text-size-adjust: none;
    
}

.unimplemented {
	COLOR: #999
}

.bug {
	COLOR: red
}

.heading {
  line-height: 0.75em;
  margin: 0px 0px 0px 0px;
  padding: 0px 0px 0px 0px;
  text-align: center;
  font-weight: bold;
  background-color:  #416779; /* #408080; */
  font-size:400%;
  color:white;
}

.content {
  margin: 5px 5px 5px 5px;
  padding: 5px 5px 5px 5px;
}

.figure {
  text-align: center;
  font-weight: bold;
  color:grey;

}

.code {
  font-family: "Coutier";
  margin: 25px 25px 25px 25px;
  padding: 25px 25px 25px 25px;
  font-weight: bold;
  background-color:  #C0C0C0; /* #408080; */
  font-size:100%;
  color:black;
}
-->
</style>
</head>

<body>
<h1>
Kinsky Pronto Developer
</h1>
<h2>Overview</h2>
<p>
This page outlines how to use the standalone <code>linnControl.js</code>
ProntoScript (PS) library within a bespoke Pronto activity, (for example, controlling a customer's TV), to allow the activity to also control a preamp via the DS's proxied service.
</p>

<p>
The library module provides the ability to select a specified input source on either a supported Linn preamp (controlled by a RS232 connected Linn DS) or a Linn DS with integrated preamp (eg Linn Sneaky DS-I / Majik DS-I). 
</p>

<p>
Assumed familiarity: Pronto Developer Certification Level 2.
</p>

<h2>
Installation
</h2>
<p>
<code>linnControl.js</code> is a standalone source file which can be downloaded from the Linn OSS site <em>here (TBD)</em>. It should then be copied to the ProntoScript Library of your ProntoEdit Pro 2 installation. Once copied, the library module will be available for inclusion in any PS activities that you author.
</p>

<p>
<ul>
<li><p>for 
 Windows XP: <code>C:\Documents and Settings\All Users\Application Data\Philips\ProntoEdit Professional 2\Libraries</code>
</p>
</li>
<li><p>for 
 Windows Vista: <code>C:\ProgramData\Philips\ProntoEdit Professional 2\Libraries</code></p></li>
</ul>
</p>

<div class="figure"><img src="linnPreamp-01.png"><br/>Adding 'linnControl.js' to PS Libraries</div>

<h2>Capability</h2>
<p>
The ProntoScript library allows the intergrator the following control over the DS / Preamp:
</p>
<ul>
<li>Library Initialise</br>
Includes Initial Source Selection (By source index), defining the DSs preamp type (internal or external) &amp; IP address</li>
<li>Power On</li>
<li>Power Off</li>
<li>Volume Up</li>
<li>Volume Down</li>
<li>Mute</li>
<li>Un Mute</li>
</ul>

<h2>API</h2>

<h3><code>function linnControl.initialise(ipAddress, preAmpType, inputNumber);</code></h3>
<p>
<em>
This routine must be called prior to any others within this library package.
</em>
</p>
<h4><code>ipAddress</code></h4>
<p><code>ipAddress</code> is the IP address of the DS to be controlled.</p>
<h4><code>preAmpType</code></h4>
<p>
<code>preAmpType</code> takes one of the following two values:
<ul>
<li><code>linnControl.PREAMP_TYPE.EXTERNAL</code><br/>
The preamp is attached to the DS &amp; controlled via RS-232.
</li>
<li><code>linnControl.PREAMP_TYPE.INTERNAL</code><br/>
The preamp in integrated into the DS (for example Sekrit DS-I).
</li>
</ul>
</p>
<h4><code>inputNumber</code></h4>
<p><code>inputNumber</code> is the number of the input to be selected, indexed from 1.</p>
<h3><code>function linnControl.powerOn();</code></h3>
<p>
This function powers on the DS &amp; preamp.
</p>
<h3><code>function linnControl.powerOff();</code></h3>
<p>
This function powers off the DS &amp; preamp.
</p>
<h3><code>function linnControl.volumeInc();</code></h3>
<p>
This function increments the volume by one unit.
</p>
<h3><code>function linnControl.volumeDec();</code></h3>
<p>
This function decrements the volume by one unit.
</p>
<h3><code>function linnControl.mute();</code></h3>
<p>
This function mutes the volume.
</p>
<h3><code>function linnControl.unMute();</code></h3>
<p>
This function restores the un-mutted volume setting.
</p>
<!--
<h3><code>function linnControl.toggleMute();</code></h3>
<p>
This function toggles the mute setting.
</p>
-->
<h3><code>function linnControl.lipSyncInc();</code></h3>
<p>
This function increments the lip sync by one unit.
</p>

<h3><code>function linnControl.lipSyncDec();</code></h3>
<p>
This function decrements the lip sync by one unit.
</p>

<p>
Prior to using any of the functions, the <code>linnControl</code> library must be initialised by a call to <code>linnControl.initialise</code>.
</p>


<h2>Example Usage</h2>



<p>
The simple code below initialises the library to talk to a DS with external preamp at IP address 192.198.1.64. Input number one (1) is selected and the amplifier is woken from standby.
</p>
<div class="code">
<pre>
<code>
////
//
// linnDemo.js
//
////

System.print("Starting linnDemo");

////
//
// You will need to change from below here:
//
linnControl.initialise("192.168.1.64", linnControl.PREAMP_TYPE.EXTERNAL, 1);

linnControl.powerOn();

</code>
</div>
</pre>
<div class="figure"><img src="basik-02.png"><br/>Simple Demonstration JS</div>
<p>
Should we wish to change volume then code similar to that below can be accociated with the volume buttons. Only the code for volume up is shown, to decrease the voluem calls to <code>linnControl.volumeDec();</code> should be substituted.
</p>
<div class="code">
<pre>
<code>
linnControl.volumeInc();

// Unfortunatly the onHold function must be declared within the button
// scope.
//
onHold = function (){
  linnControl.volumeInc();
}

onHoldInterval = 75; // msec
</code>
</pre>
</div>
<div class="figure"><img src="changeVolume.png"><br/>Changing the volume</div>

</body>
</html>

<!--
<pre>
function linnControl.initialise(ipAddress, preAmpType, inputNumber);
function linnControl.mute();
function linnControl.unMute();
function linnControl.volumeInc();
function linnControl.volumeDec();
function linnControl.powerOn();
function linnControl.powerOff();
</pre>
-->


